<div class="flex-column">
  <app-breadcrumb-nav-bar
    [title]="'NAVIGATION.CHECK_INS' | translate"
    [buttonType]="buttonType">
  </app-breadcrumb-nav-bar>
  <div class="check-ins-content">
    <p>{{ 'CHECK_INS.INTRO' | translate }}</p>

    <form [formGroup]="simulateForm" class="simulate-form">
      <div class="form-row">
        <mat-form-field appearance="outline" class="employee-number-field">
          <mat-label>{{ 'CHECK_INS.EMPLOYEE_NUMBER' | translate }}</mat-label>
          <input
            matInput
            formControlName="employeeNumber"
            [placeholder]="'CHECK_INS.EMPLOYEE_NUMBER_PLACEHOLDER' | translate"
            inputmode="numeric"
            maxlength="6">
          <mat-error *ngIf="simulateForm.get('employeeNumber')?.hasError('required')">
            {{ 'ERRORS.REQUIRED' | translate:{ field: ('CHECK_INS.EMPLOYEE_NUMBER' | translate) } }}
          </mat-error>
          <mat-error *ngIf="simulateForm.get('employeeNumber')?.hasError('pattern')">
            {{ 'CHECK_INS.EMPLOYEE_NUMBER_PLACEHOLDER' | translate }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="form-row date-time-row">
        <app-datepicker
          label="CHECK_INS.SIMULATED_DATE"
          controlName="simulatedDate">
        </app-datepicker>
        <mat-form-field appearance="outline" class="time-field">
          <mat-label>{{ 'CHECK_INS.SIMULATED_TIME' | translate }}</mat-label>
          <input
            matInput
            type="time"
            formControlName="simulatedTime">
          <mat-error *ngIf="simulateForm.get('simulatedTime')?.invalid && simulateForm.get('simulatedTime')?.touched">
            {{ 'ERRORS.REQUIRED' | translate:{ field: ('CHECK_INS.SIMULATED_TIME' | translate) } }}
          </mat-error>
        </mat-form-field>
      </div>
      <div class="form-row buttons-row">
        <button
          mat-stroked-button
          type="button"
          [disabled]="isLoadingEntries || !simulateForm.get('employeeNumber')?.value?.trim()"
          (click)="loadEntries()">
          {{ 'CHECK_INS.LOAD_ENTRIES' | translate }}
        </button>
      </div>
    </form>

    <section class="buttons-section">
      <button
        type="button"
        mat-raised-button
        color="primary"
        class="action-button check-in-button"
        [disabled]="!canSubmit"
        (click)="submitCheckIn()">
        {{ 'CHECK_INS.CHECK_IN' | translate }}
      </button>
      <button
        type="button"
        mat-raised-button
        color="accent"
        class="action-button check-out-button"
        [disabled]="!canSubmit"
        (click)="submitCheckOut()">
        {{ 'CHECK_INS.CHECK_OUT' | translate }}
      </button>
    </section>

    <section *ngIf="isLoadingEntries" class="loading-section">
      <p>{{ 'CHECK_INS.LOADING_ENTRIES' | translate }}</p>
    </section>

    <section *ngIf="!isLoadingEntries" class="entries-section">
      <h3>{{ 'CHECK_INS.ENTRIES_HISTORY' | translate }}</h3>
      <div *ngIf="entries.length === 0" class="no-entries">
        <p>{{ 'CHECK_INS.NO_ENTRIES' | translate }}</p>
      </div>
      <ul *ngIf="entries.length > 0" class="entries-list">
        <li *ngFor="let entry of entries" class="entry-item">
          <div class="entry-content">
            <span class="entry-type" [class.check-in]="entry.type === CheckInType.CHECK_IN" [class.check-out]="entry.type === CheckInType.CHECK_OUT">
              {{ entry.type === CheckInType.CHECK_IN ? ('CHECK_INS.CHECK_IN' | translate) : ('CHECK_INS.CHECK_OUT' | translate) }}
            </span>
            <span class="entry-date">{{ entry.date | date:'short' }}</span>
          </div>
        </li>
      </ul>
    </section>
  </div>
</div>
